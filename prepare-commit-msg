#!/bin/zsh

## copy file to .git/hooks/prepare-commit-msg
## chmod + x <file> to make it executable

COMMIT_MSG_FILE=$1
COMMIT_SOURCE=$2
SHA1=$3

# Read the first word of the commit message and capitalize it
FIRST_WORD=$(head -n1 $COMMIT_MSG_FILE | awk '{print toupper(substr($1,1,1)) tolower(substr($1,2));}')

# Create an associative array for emojis with the first word included
typeset -A emoji_map
emoji_map=(
    "Initial" "ğŸ‰ First commit"
    "Start" "ğŸ‰ First commit"
    "First_commit" "ğŸ‰ First commit"
    "Firstcommit" "ğŸ‰ First commit"
    "Add" "âœ¨ Add"
    "Bugfix" "ğŸ› Bugfix"
    "Clean" "ğŸ§¹ Clean"
    "Configure" "âš™ï¸ Configure"
    "Deploy" "ğŸš€ Deploy"
    "Document" "ğŸ“ Document"
    "Downgrade" "â¬‡ï¸ Downgrade"
    "Experiment" "ğŸ§ª Experiment"
    "Expand" "ğŸ“ˆ Expand"
    "Hotfix" "ğŸš‘ Hotfix"
    "Localize" "ğŸŒ Localize"
    "Move" "ğŸšš Move"
    "Optimize" "âš¡ï¸ Optimize"
    "Refactor" "ğŸ”¨ Refactor"
    "Remove" "ğŸ”¥ Remove"
    "Revert" "âª Revert"
    "Secure" "ğŸ”’ Secure"
    "Style" "ğŸ’… Style"
    "Test" "ğŸ§ª Test"
    "Typo" "âœï¸ Typo"
    "Update" "ğŸŒŸ Update"
    "Updateui" " ğŸ¨ Update UI"
    "Update_ui" " ğŸ¨ Update UI"
    "Update_comment" "ğŸ’¡ Update comment"
    "Updatecomment" "ğŸ’¡ Update comment"
    "Update_copy" "ğŸ’¬ Update copy"
    "Updatecopy" "ğŸ’¬ Update copy"
    "Upgrade" "â¬†ï¸ Upgrade"
    "Tag" "ğŸ”– Tag"
    "WIP" "ğŸš§ WIP"
)

# Check if the first word is in the map
if [[ ${emoji_map[$FIRST_WORD]} ]]; then
    # Prepend the emoji and the first word to the commit message
    sed -i '' "1s/^/${emoji_map[$FIRST_WORD]} /" $COMMIT_MSG_FILE
fi